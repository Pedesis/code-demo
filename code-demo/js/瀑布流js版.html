<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            padding: 0;
            margin: 0;

        }
        #wrap{
            position: relative;
        }
        .box{
           
            float: left;
            padding: 15px 0 0 15px;
        }
        .pic{
            padding: 15px;
            border:1px solid;
        }
        .pic img{
            width: 150px;
            height: auto;
        }
    </style>
</head>

<body>
    <div id="wrap">
        <div class="box">
            <div class="pic">
                <img src="images/1.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="images/2.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="images/3.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="images/4.jpeg" alt="" srcset="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="images/1.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="images/4.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="images/3.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="images/1.jpeg" alt="" srcset="">
            </div>
        </div>
        <div class="box">
                <div class="pic">
                    <img src="images/1.jpeg" alt="" srcset="">
                </div>
            </div>
            <div class="box">
                <div class="pic">
                    <img src="images/4.jpeg" alt="" srcset="">
                </div>
            </div>
            <div class="box">
                <div class="pic">
                    <img src="images/3.jpeg" alt="" srcset="">
                </div>
            </div>
            <div class="box">
                <div class="pic">
                    <img src="images/1.jpeg" alt="" srcset="">
                </div>
            </div>
    </div>
</body>
<script>
window.onload=function(){
    waterfull();
    function waterfull(){
        var boxs=document.querySelectorAll("#wrap>.box");
    var oBoW=boxs[0].offsetWidth;
    var cols=Math.floor(document.documentElement.clientWidth/oBoW/2);
     wrap.style.cssText="width:"+cols*oBoW+"px;margin:0 auto";
     var arrH=[];
     for(var i=0;i<boxs.length;i++){
         if(i<cols){
             arrH[i]=boxs[i].offsetHeight;
         }else{
             var minH=Math.min.apply(null,arrH);
             var minIndex=getIndex(arrH,minH);
            // console.log(arrH[minIndex]) ;
             boxs[i].style.position="absolute";
             boxs[i].style.top=minH+"px";
             boxs[i].style.left=minIndex*oBoW+"px";
            // console.log(arrH[minIndex]) ;
             arrH[minIndex]+=boxs[i].offsetHeight; 
             console.log(arrH[minIndex]) ;
         }
     }
     console.log(arrH);
     function getIndex(array,min){
         for(var  i in array){
            if(array[i]==min){
                return i;
            }
         }
     }
    }
    document.getElementsByTagName
    window.onscroll=function(){
        var dataimg={"data":[{"src":"1.jpeg"},{"src":"4.jpeg"},{"src":"2.jpeg"},{"src":"3.jpeg"},{"src":"1.jpeg"}]}
        if(canChange){
            for(var i=0;i<dataimg.data.length;i++){
                var box=document.createElement("div");
                box.className="box";
                var pic=document.createElement("div");
                pic.className="pic";
                var img=document.createElement("img");
                img.src="images/"+dataimg.data[i].src;
                box.appendChild(pic);
                pic.appendChild(img);
                wrap.appendChild(box);
            }
           
           // console.log(dataimg.data);
        }
        waterfull();
    }
    canChange();
    function canChange(){
        var boxs=document.querySelectorAll("#wrap>.box");
         var lastboxtop=boxs[boxs.length-1].offsetTop;
         //console.log(lastboxtop);
         var sH=document.body.scrollTop||document.documentElement.scrollTop;
         var wH=document.body.clientHeight||document.documentElement.clientHeight;
        // console.log((lastboxtop<sH+wH)?true:false);
         return (lastboxtop<sH+wH)?true:false;

    }
    
}
</script>

</html>